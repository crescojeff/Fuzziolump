<tw-storydata name="Fuzziolump" startnode="34" creator="Twine" creator-version="2.2.1" ifid="810AC854-AE1B-4BAB-8175-BAF552CB931B" zoom="1" format="SugarCube" format-version="2.21.0" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">

#enemy {
	width: 100%;
	position: center;
	padding: 1em;
	border: solid #000 0.05em; 
	border-radius: 0.1em;
	background-color: #EBE;
	font-size:1.5rem; 
	color:#000;
	text-align:left; 
	box-shadow: #000 0.5em 0.5em 0;
}

#player {
	width: 100%;
	position: center;
	padding: 1em;
	border: solid #000 0.05em; 
	border-radius: 0.1em;
	background-color: #B0E0E6;
	font-size:1.5rem; 
	color:#000;
	text-align:left; 
	box-shadow: #000 0.5em 0.5em 0;
}

#combatlog {
	width: 100%;
	position: center;
	padding: 2em;
	border: solid #000 0.05em; 
	border-radius: 0.1em;
	margin: auto;
	background-color: #ffffff;
	font-size:1.5rem; 
	color:#000;
	text-align:left; 
	box-shadow: #000 0.5em 0.5em 0;
}








































</style><script role="script" id="twine-user-script" type="text/twine-javascript">
Config.history.maxStates = 0;   // no history limit
//alert("config ctor: "+Config.constructor);
var known_id_nuvi = false;
var test = 0;

// Character object definition
function Character(name){
	
	this.name = name;
	this.gender = "";
	
	// attribute scores reflect the character's capabilities.
	// we'll use Pathfinder style scores, where 10 is sort of neutral
	// and any modifier needed is calculated as (score-10)/2
	this.attributes = {
		"charisma":10,
		"intelligence":10,
		"wisdom":10,
		"strength":10,
		"dexterity":10,
		"constitution":10
	}
	
	// affinities will be a simple String character name key -> integer affinity value mapping
	// that reflects how a given character feels about this character.
	// 0 is defined as totally neutral, negative values are bad and
	// positive values are good.  
	this.affinities = new Map();
	
	// a character's inventory reflects the items in the world that it is
	// currently carrying and can access.
	this.inventory = [];
	
	// a simple array of keyword/phrases that indicate behavior mod in certain contexts, e.g. targetCharacter.name+"_is_digger_good"
	// to indicate that targetCharacter is as good as mole, wombats, and
	// other simple lovely creatures that happily burrow and build all their
	// lives, peaceful, passionate, and productive.
	this.inductive_bias = [];
}

function Room(){
	
}

// Player object definition
function Player(){
	// inherit from Character
	Character.call(this,"The Human");
	
	
	
}

/*//moved into Character object, of which Player is an instance
function Affinities(){
	this.nuvi_affinity = 0;
}

var playerAffinities = new Affinities();
*/

// create the Player as a Character
State.variables.characters = {
	"player" : new Player(),
	"nuvi" : new Character("Nuvi"),
	"shimmerin" : new Character("Shimmerin")
}

/* // is this delegate inheritance?  MDN suggests that delegation proto inheritance can allow state to creep between instances somehow with common fields being changed for all instances, but I don't understand what they mean.  This works as expected.
var characters = State.variables.characters;
alert("player is "+characters["player"].name+", nuvi is "+characters["nuvi"].name+", and shimmerin is "+characters["shimmerin"].name);
*/
	
// establish Player party
State.variables.party = [State.variables.characters["player"]];

/*// moved to Character object, from which Player inherits 
// establish Player inventory
State.variables.inventory = [];
*/

/// begin Shimmerin ///
State.variables.field_mod_anicemole_burrowed = "anicemole_burrowed";

function AnIceMole(){
	this.path_index = 0;
	this.path_room_count = 4;
	// the path an ice mole can take
	this.ice_mole_path = ["Shimmerin_Chase_Frozen_Stair","Shimmerin_Chase_Diamond_Throneroom","Shimmerin_Chase_Treasure_Of_Stillness","Shimmerin_Chase_Crystal_Gardens"];
	// the ice mole's current position
	this.ice_mole_room = this.ice_mole_path[this.path_index];
	
	/**
	Advances anicemole along his path
	*/
	this.advance = function(){
			// advance the path index, accounting for wraparound
		  this.path_index++;
			if(this.path_index == this.path_room_count){
				this.path_index = 0;
			}
			
			// set the current room to the room along the path
			// at the new index
			this.ice_mole_room = this.ice_mole_path[this.path_index];
		  alert("path index is "+this.path_index+", which resolves to "+this.ice_mole_path[this.path_index]);
	} // end advance function
	
	/**
	Anicemole burrows hastily away!  This will modify the current room and also advance the mole.
	*/
	this.burrow = function(){
		// add the current passage to list of rooms the mole has burrowed through.  This isn't quite ideal since not all passages are a discrete room, but in the case of the shimmerin maze where the mole will be, they are.  Better might be to check the passage tags for 'room' before making this mod?  Of course, the mole shouldn't be burrowing outside a room passage anyway, so...
		//State.variables.mole_burrowed_array.push(passage());
		
		// add anicmole burrowed to the mods array for the current room
		var currentModsArray = State.variables.field_mods_map.get(passage());
		
		// need to check for null return of field mods at given passage and init currentModsArray to an empty new array in that case
		if (typeof currentModsArray == 'undefined'){
			currentModsArray = [State.variables.field_mod_anicemole_burrowed];
			State.variables.field_mods_map.set(passage(),currentModsArray);	
		}else if(!currentModsArray.includes(State.variables.field_mod_anicemole_burrowed)){

						 // field mods exist for this passage, but they do not yet include anicemole's burrowing.  Add burrowing to it.
						 currentModsArray.push(State.variables.field_mod_anicemole_burrowed);
		
	 }
		
		
		this.advance();
	}
	
	// flag indicating that the ice mole is present in the room when the player enters and there needs to be text detailing how he burrows away
	//this.ice_mole_burrow_flag = false;
}

// grant access to anicemole instance in the story
State.variables.anicemole = new AnIceMole();

/**
A map of room names to arrays of modification descriptor strings that can be used to look up rooms that have runtime modification, e.g. anicemole burrowed and changed something in rooms x, y, and z so if room z checks this map's return value array for 'anicemole_burrowed' it will return true and know that burrowing mods need to be handled.  Interested rooms can check at the top of their passage with field_mods_map.get(passage())
*/
State.variables.field_mods_map = new Map();

// todo: at the top of every room in the shimmerin maze, the mole will move his position to the room at the next index in his path.  If the mole position matches the current passage title, the mole description will be part of the passage and the mole will burrow to escape the player.  The burrow flag will be raised, indicating that at the top of the next passage we do not need to auto-move the mole again.  Once the burrow flag is read as true, it will be lowered.  If the mole burrows away in the Treasure of Stillness room, the Tiny Tiara will be freed for acq.

/// end Shimmerin ///

/*
Config.constructor.prototype.combat = function Combat(){
	this.name = "";
	this.actors = {};
	this.getName = function(){
		return this.name;	
	}
}
*/

	






































</script><tw-passagedata pid="1" name="Chamber of Soiled Vestments" tags="" position="230,37" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $inv to []&gt;&gt;
&lt;&lt;set $known_id_nuvi to false&gt;&gt;

&lt;!--
&lt;&lt;print &quot;passage is &quot;+passage()&gt;&gt;
&lt;&lt;print &quot;hasVisited(&quot;+passage()+&quot;) is &quot;+hasVisited(passage())&gt;&gt;
&lt;&lt;print &quot;visited(&quot;+passage()+&quot;) is &quot;+visited(passage())&gt;&gt;
--&gt;
&lt;&lt;/nobr&gt;&gt;\
&lt;&lt;if !(visited(passage()) &gt; 1)&gt;&gt;\
The musty warmth of the laundry room has always appealed to you; it suggests a friendly invitation to the unknown, and there always seems to be another unexplored dark corner.  You smile contentedly at this thought, imagining that few people bother to appreciate the subtle treasures in a blanket of soft shadow.  A shared laundry like the one in your building is exponentially better, since every traveler through it leaves a little bit of themselves behind, enlivening the story.  If you were the type to rifle throw other people&#39;s skivvies it might be livelier-still, but that&#39;s intrusive. Also gross.

The dryer rumbles to a halt, then buzzes obnoxiously.  The world sure seems to love its noise.
&lt;&lt;else&gt;&gt;
You stand in the laundry room.  A speck of lint drifts by, placidly.
&lt;&lt;/if&gt;&gt;

Gather your clothes from [[the dryer-&gt;Dryer]]
Check drawers in [[the ancient table-&gt;Ancient Table]]</tw-passagedata><tw-passagedata pid="2" name="Footer Menu" tags="footer" position="13,152" size="100,100">Check [[inventory-&gt;Inventory]]</tw-passagedata><tw-passagedata pid="3" name="Dryer_alt" tags="alt_passage" position="126,184" size="100,100">Ducking down peer to inside, you&#39;re greeted by a pleasant surprise -- your clothes are fully dry for once!  As you pull clothes from the dryer and pile them in your hamper, you note that only a single sock of your favorite pair is present and accounted for. They&#39;re the super-fuzzy wooly kind, and are patterned with kittens playing with balls of yarn on one and puppies chasing sticks on the other.  Looking down at the lonely puppy sock, your heart aches a little.  Poor guy.  Practically climbing halfway into the dryer, you reach and flail about for the errant kitten sock to no avail.  
Re-adjusting yourself, you poke your head in to take a closer look, expecting ruefully to see only empty dryer walls. Instead, you see the head, shoulders, and bountiful cleavage of a miniature, winged woman staring at you with anxious eyes.  Before you can react, a hirsute arm snakes out and grabs you, pulling you into the dryer with monstrous strength.  You close your eyes and brace for the collision with the merciless metal wall, but it doesn&#39;t come... after a moment, a warm breeze and the unmistakeable smell of pine needles coaxes you to open your eyes. </tw-passagedata><tw-passagedata pid="4" name="Ancient Table" tags="" position="898,40" size="100,100">Inside the drawer rest one [[9-Volt battery-&gt;9-Volt]], a [[short length of copper wire-&gt;copper_wire]], a pair of [[rubber gloves-&gt;rubber_gloves]], a [[singed penny-&gt;penny]], and a battered [[pocket-knife-&gt;pocket_knife]].  Someone was attempting amateur electrical repairs.  Suddenly you find yourself thankful -well, less resentful anyway- for the over-sensitive smoke alarm that puts the building&#39;s occupants out in the cold at least once a quarter, and always in the middle of the night.
[[close the drawer -&gt;Chamber of Soiled Vestments]] </tw-passagedata><tw-passagedata pid="5" name="Inventory" tags="" position="42,337" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="6" name="9-Volt" tags="" position="543,193" size="100,100">Time and tide (by the look of it, it has actually been swimming) have not been kind to this old fellow, but he might still have some juice left.
take it
[[leave it -&gt;Ancient Table]] </tw-passagedata><tw-passagedata pid="7" name="copper_wire" tags="" position="678,198" size="100,100">The copper wire is about 1 meter long and 7 millimeters in diameter.
[[take it-&gt;copper_wire_taken]]
[[leave it -&gt;Ancient Table]] </tw-passagedata><tw-passagedata pid="8" name="rubber_gloves" tags="" position="801,193" size="100,100">These neon-yellow rubber gloves have seen a lot of abuse, and little washing.  You wrinkle your nose at the smell emanating from them (print: $inv).
take it
[[leave it -&gt;Ancient Table]] 
</tw-passagedata><tw-passagedata pid="9" name="penny" tags="" position="951,241" size="100,100">This is an especially bad sign; completing a fuse with a penny is a classic strategy for starting electrical fires in the handbook of the incompetent handyman.  At least this one is not currently serving as a vector to fiery oblivion for the building&#39;s occupants, but another one may have replaced it... you shudder and try to put it out of your mind.
take it
[[leave it -&gt;Ancient Table]] </tw-passagedata><tw-passagedata pid="10" name="pocket_knife" tags="" position="1101,241" size="100,100">A simple folding pocket knife, its blade pitted by age, the elements, and lack of maintenance.  Still, the edge is sharp and the knife is compact when folded.
take it
[[leave it -&gt;Ancient Table]] </tw-passagedata><tw-passagedata pid="11" name="copper_wire_taken" tags="" position="682,341" size="100,100">(set: $inv to $inv + (a: &quot;copper_wire&quot;))</tw-passagedata><tw-passagedata pid="12" name="Dryer" tags="" position="230,187" size="100,100">Ducking down peer to inside, you&#39;re greeted by a pleasant surprise -- your clothes are fully dry for once!  As you pull clothes from the dryer and pile them in your hamper, you note that only a single sock of your favorite pair is present and accounted for. They&#39;re the super-fuzzy wooly kind, and are patterned with kittens playing with balls of yarn on one and puppies chasing sticks on the other.  Looking down at the lonely puppy sock, your heart aches a little.  Poor guy.  Practically climbing halfway into the dryer, you reach and flail about for the errant kitten sock to no avail.  

Re-adjusting yourself, you poke your head in to take a closer look, expecting ruefully to see only empty dryer walls. Instead, you see the head, forelegs, and fuzzy whiskers of an otter staring at you with anxiety quaking in its fathomless black eyes.  He&#39;s wearing a darling little tophat, bowtie, and a gold-rimmed monocle adorns one eye.  Before you can react, he boops your nose with a soft paw, his expression apprehensive. After a bizarre moment staring at each other in this manner, reality begins to spin and you fear someone has turned the dryer on with you halfway inside!  You close your eyes, bracing for the inevitable pain as you evaluate the strength of the dryer&#39;s tumble cycle first-hand.  There&#39;s no pain, however, and after only a few dizzying seconds [[the world-&gt;Atrium Glade]] stills.</tw-passagedata><tw-passagedata pid="13" name="Atrium Glade" tags="fluffy_forest fuzziolump socket" position="228,347" size="100,100">&lt;&lt;if visited() == 1&gt;&gt;
Only, it&#39;s a different world than the one you left.  A cool breeze and the unmistakeable smell of pine needles coaxes you to open your eyes.

You find yourself in a wintry forest glade. [[Evergreen foliage-&gt;Atrium_Glade_Foliage]], bearing a light sprinkling of snow such that it resembles sugar-dusted sweets, surrounds you.  The otter, which sports a pair of fluffy brown wings the same shade as its sleek tawny fur, flits about your head, appraisingly.  His little tophat tilts gently back and forth in a hypnotizing pattern, in time with the rhythm of his lazy wing beats.  

&lt;&lt;else&gt;&gt;
A refreshing cool breeze carresses your cheek and ruffles the wintergreen foliage.  Only the gentle fwump fwump of the otter&#39;s wings breaks the tranquil silence, a comforting constant.
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $current_room to passage()&gt;&gt;
Current passage is: $current_room
You feel the need to speak:
[[&quot;Where am I?&quot;-&gt;Atrium_Glade_Where_Player]]
[[&quot;Who are you?&quot;-&gt;Atrium_Glade_Who_Nuvi]]
[[&quot;What are you?&quot;-&gt;Atrium_Glade_What_Nuvi]]
[[&quot;I really like your wings!&quot;-&gt;Atrium_Glade_Wings_Compliment_Nuvi][$playerAffinities.nuvi_affinity += 1]]

// looks like Sugarcube will not create a variable for you on the fly as part of an operation like this; $nuvi_affinity needs to have already been set somewhere
//[&quot;Test&quot;][$nuvi_affinity += 1]
test is: &lt;&lt;print $test&gt;&gt;
Affinity is: &lt;&lt;print $playerAffinities.nuvi_affinity&gt;&gt;

</tw-passagedata><tw-passagedata pid="14" name="Alpha_Thanks_Player_Of_Romantic_Interest" tags="alpha user-targeted" position="812,329" size="100,100">/*something to the tune of &#39;hope you&#39;ve enjoyed exploring the land of Fuzziolump!  Speaking of exploring, would you like to explore a relationship with me?&#39; [cripes that sounds lame.  Think of better phrasing if we go with this one] and/or something referencing celebratory redwall-esque feasts in game and say &#39;speaking of feasting, would you like to get dinner sometime?*/</tw-passagedata><tw-passagedata pid="15" name="Atrium_Glade_Where_Player" tags="query conversation" position="24,482" size="100,100">&quot;You&#39;ve landed in the glorious world of [[Fuzziolump-&gt;Fuzziolump_Desc]], a reality born from your own species&#39; collective psyche! /*something about advent of electricity and telecomm tech leading to quantum tunneling/entanglement signal propagation and accidental influence of the development of life in this alternate universe.  Also something more directly SciFey, such that the particular thoughts/feelings conveyed by those signals matter and were shaping Fuzziolump even before telecomm simply from being experienced by humans.  Explains the personification of memes in the lumpkins, but not so much why they&#39;re mystified by human tech that comes through dryers.*/ To use more modern terminology, we were born of the internet... but in a good way!

&quot;Specifically, you&#39;re standing in the Atrium Glade.  This is one of many portals to and from Earth that we call sockets.  Each socket has its own quirks, but generally conform to two main rules: they can operate two ways (Fuzziolump-&gt;Earth, Earth-&gt;Fuzziolump), and they can only be opened from Fuzziolump.  I like the Atrium Glade because everything looks like it should be in a bakery window!&quot;  The otter licks his fuzzy chops wistfully.

[[&quot;Why did you bring me here?&quot;-&gt;Fuzziolump_Main_Quest_Desc]]</tw-passagedata><tw-passagedata pid="16" name="Atrium_Glade_Who_Nuvi" tags="query conversation" position="339,653" size="100,100">&lt;&lt;set $known_id_nuvi to true&gt;&gt;
My name is Nuvi, and I&#39;m here to be your adorably helpful guide.  No, I am not optional.  No, you cannot set me to silent mode.

[[Exit Conversation-&gt;Atrium Glade]]</tw-passagedata><tw-passagedata pid="17" name="Atrium_Glade_What_Nuvi" tags="query conversation" position="374,530" size="100,100">Crossing his little paws, &lt;&lt;if $known_id_nuvi&gt;&gt;Nuvi&lt;&lt;else&gt;&gt;the winged otter&lt;&lt;/if&gt;&gt; huffs, &quot;That&#39;s a rather rude question.  But I understand; you&#39;re used to a world with only a single sapient species -- how lonely you must be!  I&#39;d wager that where you&#39;re from, socialization is terribly dull for those who fit in, and all but impossible for those who don&#39;t.  &lt;&lt;if $known_id_world&gt;&gt;Fuzziolump&lt;&lt;else&gt;&gt;This world&lt;&lt;/if&gt;&gt; doesn&#39;t have that problem.&quot;

[[Exit Conversation-&gt;Atrium Glade]]</tw-passagedata><tw-passagedata pid="18" name="Fuzziolump_Desc" tags="desc conversation" position="194,513" size="100,100">&quot;Oh, it&#39;s a wondrous place full of multifarious sapient species.  You&#39;ll recognize many of our denizens&#39; general forms, but they&#39;re quite different from the simple animals in your world.&quot;

[[Exit Conversation-&gt;Atrium Glade]]</tw-passagedata><tw-passagedata pid="19" name="brainstorming" tags="design brainstorm dev" position="1,0" size="100,100">-Magic System: nanites?  It could go with the whole crap from Earth lost in dryers theme, though it wouldn&#39;t explain immediately how Fuzziolump came to be in the first place.  Anyway, I was thinking nanites that are sensitive to specific electromagnetic fields generated by thought patterns of organisms, and take predictable actions based on the field modulations.  This would effectively allow for psychic/emotional magic by proxy, and could even explain how the creatures of FUzziolump came to be as they are (genetic manipulation to create sapience and foment nanite propogation and maximum evolution efficiency).

--I&#39;m actually preferring something more fantasy-esque, such as subatomic organisms that react to thought/emotion EMFs in predictable ways.  That or maybe some particle or link between particles in Fuzziolump that reacts to psychic EMFs without any particular organism with motivations involved, such that the situation is effectively more direct rather than by proxy (really don&#39;t wanna proc memories of fucking midiclorians)

--the human&#39;s mana stat should be emotion levels, which will be modified by various actions.  Some will increase with related magic usage, but there will be negative consequences if they get too high (e.g. anger)!


-Setting: SciFey meets Redwall Abbey.  Basically a world similar to the Pathfinder primordial Fey world, but with slightly less magic and more pseudo-science behind its inception via imagination/emotion.  Also, Redwall level cute creatures all over the place.  Specifically, I was thinking something along the lines of somehow &lt;insert pseudoscience here&gt; the world of Fuzziolump came into being as a parallel universe derived from the thoughts and feelings of earth lifeforms.  This process was glacial at first, but sped up greatly as sapience emerged.  Once sapient thought was being communicated by proxy via radio waves in various and sundry forms, the development process increased exponentially.  Basically Fuzziolump was fairly unevolved until humanity came around, and then was fairly primitive and amorphous until humans invented radio communications; the direct point to point electronic comm of telegraphy helped, but was less effective than blasting out thoughts to the ether for reception at some planned point, but then also anywhere else that happened to be receiving.
-Story: a group of Fuzziolumpkins have gone rogue and are trying to use human tech to destroy others?  Doesn&#39;t really jive with the nanite thing, or any magic system really.  I was thinking this when the world was supposed to be just animals with incidental human tech who eventually grew smarts because smarts were needed to survive in a world of randomly appearing and potentially deadly high technology.  I&#39;m thinking I want to go more Sanderson fantasy though; less pressure to explain everything in terms of real-ish science.

Okay, much more interesting story idea based on new SciFey setting -- the Fuzziolumpkins have been developing much more quickly since the onset of radio based tech in the 20th century, and now with broadband internet they&#39;re beginning to see a rather worrying trend: creatures something like gods are being born.  This apotheosis is frightening and occasionally disastrous, so they brought in a human creative to help them understand how to control and potentially dismantle some of the organisms resultant from human and now Fuzziolumpkin (which was inspired by human but now, relatively recently thanks to radio, exists independently) imagination.  At least one of these will be some sort of big bad that fights back, and others will be sympathetic spirits that are still problematic.

-Combat:
Two easy options for combat in a text adventure
1. Choose your own adventure style, where each combat situation is really just another choice and only the details of the choice and associated consequences make it combat.
Pros:
-relatively easy to implement
Cons:
-combat doesn&#39;t feel much different from anything else
-in order for combat to be interesting, the author needs to ensure that the consequences of the offered choices could reasonably be deduced by the player ahead of time such that you don&#39;t run into those frustrating &#39;swing sword -&gt; obviously that means you catch your arm on a rock and the dragon eats you&#39; situations that leave the player feeling powerless and the game mechanics arbitrary.

2. RPG style turn-based combat with uniform set of actions and usual conditions for victory e.g. enemy or player runs out of HP.  In this case the choice set would be uniform and act as the combat interface.
Pros:
-player is more in control
-the system supports interesting combat and doesn&#39;t require as much setup and forethought by the author
Cons:
-relatively difficult to implement
-may leave combat less &#39;storied&#39; if sufficient wrapping narrative is not provided

-Rooms:
--Frosted Forest[
	---Atrium Glade{
		1. Nuvi
		2. Sprig of Holly
	}
	---Christmas Pines{
	}
	---Frigid Mirror Lake{
	}
	---Cozy Bear Den{
	}
	---Silent Stillness{
	}
	---Crystal Palace{
	}
	---Snow Fort{
	}
	---Sleigh Ride{
		1. Pulled by walri
	}
	---Wooly Mammoth Ride{
	}
	
]
--Badger Maze
--Arborial Spider Web City
--Salamander Volcano
--Unicorn Plains
--Siren Grotto
--Nymph Willows: shade and privacy!
--Dryad Groves
--Primordial Booze: alcohol concentration where inhibitions are least and creative forces amongst the greatest.  Many small gods are popping up here, and obviously removing the booze is not an acceptable solution to control the situation.
--Howling Caverns
--Vampire McMansions
--Grand Rabbit Hutch
--Wombat Warren
--God Generators (thought/emotion extremes themed)[
1. Weeping Waterfall
2. Furious Furnace
3. Blissful Blossoms
]


-Objects:
--Treeminals
--Onyx eyes
--Staff of Creation: said to be a limb of the First Tree...
--Sprig of Holly: focus for imagination due to its strong association with being a divine focus in lore.  Also, it has actually become a divine focus for the blossoming dryad goddess Holly for the same reason!  And yes, the name collision is confusing. 

-Characters:
--Nuvi the flying otter guide: player&#39;s guide through their adventure.  Swims through the air via gravity assist of some sort; wings are slightly for precision maneuvers and mostly for show.

-Storyboard:
1. human goes through the dryer to the snowy glade and meets Mr. Tumn-- er Nuvi or whoever, the flying otter guide.  Otter explains somewhat about Fuzziolump and what the human should be doing there. EXPOSITION!

2. nuvi explains the problem they&#39;re having with pesky gods being born, and says that a consensus was reached by the animal council (insert animal themed council pun here) that a human creative should be brought in to help figure out how to slow and undo some of the creativity flying around.

3. first step on that journey is heading to the council so they can give more information on particularly troubling developments and decide which the human should address first.  The council resides in the Wombat Warren which is located north of the Frosted Forest in which the Atrium Glade resides.  The human must travel North through the Frosted Forest until the trees thin and the snows disappear, and the ecosystem suddenly changes to a warm savannah called the Bush.  There they will start to see holes everyplace, and Nuvi will inform the human that these all lead to the Wombat Warren.  

/*
However, some also travel to private dens, so the human must find public tunnels; this requires a wombat&#39;s sense.  Lacking same, the human must try and fail until patterns indicating private tunnels are noted in the individual tunnel descriptions.  The tunnel descriptions should show up randomly, and each failure tosses the human back to the edge of the Bush; this way they actually need to either get lucky or recognize the signs and pass over private burrows until they come randomly to one that does not fit the private bill, which will be a public tunnel.
*/
What Wombats Want: However, most tunnels also pass by or even through private dens so the human must figure out what each wombat family they encounter wants in exchange for passage.  This will be hinted at in the descriptions of the dens, and some wombats may &quot;help&quot; with riddles. 

4. once inside the Wombat Warren, the human meets the animal council.  They inform human that Holly is the first god to approach, since she is growing like many, many weeds and is relatively amiable.  The main question is how the human should go about regressing or at least controlling the creativity that is driving her growth; the human has several choices for how to approach this [choice]{
a. violence (find vital module if possible, cut it out) [effect: nuvi aff -5, council aff +1]
b. hug it out (try to convince her that her wild growth is becoming deleterious to her fellow &#39;lumpkins) [effect: nvi aff +3, council aff: -1]
c. prune (find out what imagination and emotion specifically fuels Holly, and find a way to limit her supply to the tune of reducing her expanse to a steady state -- halting her growth rather than reversing it) [effect: Nuvi aff +5, council aff: +3]
d. dig up the root (find out what imagination and emotion specifically fuels Holly, and find a way to starve her of same until she wilts) [effect: Nuvi aff -10,  council aff: -5]

5. Having decided on a strategy, the human exits the Wombat Warren and heads towards the Blissful Blossoms forest to the West, where Holly makes her home.  On the way, the human is challenged by Puck, a pesky small god of the wind who listens to secrets and overheard the planning session with the council; he is in love with Holly, and will not hear of any suppression of her growth.  He fights the human!  
}

Demo Scope{
 -intro meeting Nuvi and with basic Fuzziolump setting description
 -travel to Wombat Warrens and entry puzzle
 -discussion about gods and how to prune them with council
 -combat with Puck
}</tw-passagedata><tw-passagedata pid="20" name="Atrium_Glade_Wings_Compliment_Nuvi" tags="nuvi character_dev affinities" position="468,358" size="100,100">&quot;Why thank you, human!  They help me execute precise maneuvers in the air, but other than that they&#39;re mostly for show -- I fly by lessening the effect of gravity on myself with _&lt;todo: some wordplay on mana/magic&gt;&quot;  He zooms around your head, swimming through the air without flapping his wings to demonstrate.

[[Exit Conversation-&gt;Atrium Glade]]</tw-passagedata><tw-passagedata pid="21" name="Atrium_Glade_Foliage" tags="" position="518,497" size="100,100">You examine the nearest frosted greenery, a holly bush whose bright red berries contrast beautifully with the pure white snow.  Brushing a hand over the bush idly, you jump higher than you thought possible when one of its branches extends creakily and a sprig reaches out to pat you right back.  As if taken aback and perhaps chagrined by your startled reaction, the branch withdraws shyly, and the [[sprig of holly]] flutters gently to the ground. </tw-passagedata><tw-passagedata pid="22" name="sprig of holly" tags="" position="518,647" size="100,100">todo: add the sprig of holly to the inventory; this will help the player with Holly later</tw-passagedata><tw-passagedata pid="23" name="Test Arena" tags="dev test" position="723,627" size="100,100">&lt;&lt;script&gt;&gt;
//var combatPassage = Story.get(&quot;CombatArena&quot;);
//combatPassage.prototype.testField = &quot;helloarena&quot;;
//Would need to modify the prototype of Passage itself
&lt;&lt;/script&gt;&gt;
&lt;&lt;set $npcs to {
	&quot;Ralph&quot;		: {name: &quot;Ralph&quot;, hp: 10, inventory:[]},
	&quot;Jane&quot;		: {name: &quot;Jane&quot;, hp: 10, inventory:[]}
}&gt;&gt;

&lt;&lt;set $player = {name: &quot;Playername&quot;, hp: 10, inventory:[&quot;key&quot;, &quot;sword&quot;]}&gt;&gt;

&lt;&lt;set $village = []&gt;&gt;
&lt;&lt;set $village.push(&quot;Ralph&quot;)&gt;&gt;	/% ralph is placed in the village %/

Ralph&#39;s HP: &lt;&lt;= $npcs[&quot;Ralph&quot;].hp&gt;&gt;

First Village&#39;s HP: &lt;&lt;= $npcs[$village[0]].hp&gt;&gt;
&lt;&lt;set $combat to {
	&quot;player&quot;		: {name: &quot;Ralph&quot;, hp: 10, inventory:[], toString(){
			return &quot;Name: &quot;+this.name+&quot;, HP: &quot;+this.hp+&quot;, inv: &quot;+this.inventory;
		}
	},
	&quot;enemy&quot;		: {name: &quot;Jane&quot;, hp: 10, inventory:[]}
}&gt;&gt;
[[&quot;Try your luck in the combat arena!&quot;-&gt;CombatArena]]</tw-passagedata><tw-passagedata pid="24" name="CombatArena" tags="" position="881,624" size="100,100">&lt;&lt;script&gt;&gt;
/*
//alert(&quot;Current Passage is &quot;+passage());
//alert(&quot;visited CombatArena: &quot;+hasVisited(passage()));
var combatPassage = Story.get(passage());//Story.get(&quot;CombatArena&quot;);
Passage.prototype.testField = &quot;&quot;
Passage.prototype.testMethod = function() {
    return this.testField;
}
combatPassage.testField = &quot;test&quot;
alert(combatPassage.testMethod());
*/
/*
var myCombat = new Combat();
myCombat.name = &quot;The battle of impossible love!&quot;;
alert(&quot;Watch as the wind and warriors rage as one in: &quot;+myCombat.getName());
*/
State.variables.combat[&quot;player&quot;].inventory[0] = &quot;Rusty Jagged Sword&quot;
alert(&quot;Player is &quot;+State.variables.combat[&quot;player&quot;]);
&lt;&lt;/script&gt;&gt;
</tw-passagedata><tw-passagedata pid="25" name="CombatDef" tags="dev testing" position="854,489" size="100,100">&lt;&lt;script&gt;&gt;
alert(&quot;inside CombatDef&quot;);
// todo: I&#39;m getting Combat not defined and the alert is showing, so I guess the scope of this js is the script blocks?
function Combat(){
	this.name = &quot;&quot;;
};
&lt;&lt;/script&gt;&gt;
&lt;&lt;script&gt;&gt;
alert(&quot;inside CombatDef second block&quot;);
// throws Combat undefined error; js inside script blocks must have script block scope
var myCombat = new Combat();
myCombat.name = &quot;testCombat&quot;;
alert(&quot;combat name is &quot;+myCombat.name);
&lt;&lt;/script&gt;&gt;</tw-passagedata><tw-passagedata pid="26" name="CombatReady" tags="dev testing" position="637,978" size="100,100">&lt;&lt;script&gt;&gt;
variables().ehp = 200;
variables().eatkname = &quot;MOTHERF*CKING FIRE&quot;;
&lt;&lt;/script&gt;&gt;
[[&quot;Fight the Mighty Dragon!&quot;-&gt;DragonFight][$ehp to 400, $eatkname = &quot;fire&quot;]]</tw-passagedata><tw-passagedata pid="27" name="DragonFight" tags="" position="645,1121" size="100,100">&lt;&lt;script&gt;&gt;
alert(&quot;ehp is &quot;+State.variables.ehp);
alert(&quot;eatk is &quot;+State.variables.eatkname);
&lt;&lt;/script&gt;&gt;</tw-passagedata><tw-passagedata pid="28" name="Fuzziolump_Main_Quest_Desc" tags="desc conversation quest main_quest" position="2,673" size="100,100">&quot;Ah yes, our great need.  You see, Fuzziolump has long been a place of peace for the most part, but recently there has been an upwelling of violence and turmoil.  The cause is our gods.  

We didn&#39;t have any at first.  The fully mortal lumpkins are quite complex enough, and even with the vast sum of Earth&#39;s imaginings it took ages for us to develop.  Several centuries have passed since we grew smart enough to start recording our history, and it seems the more we wrote and thought and felt the experiences of life, the faster Fuzziolump grew.  Its own denizens&#39; imaginings fuel it in addition to Earth&#39;s pool of creative energy, and this exponentiation has led to more potent lifeforms.  Effectively, gods.

Now, this might be cause for celebration -- a whole new category of sapient life, more deeply sapient than any of us can fathom!  Unfortunately, power and depth of mind do not equate to wisdom.  The young gods of Fuzziolump are all very different, but their common trait is an understandable lack of experience combined with an unprecedented ability to influence the world around them.  Some have even learned to syphon off the creative energy Fuzziolump thrives on, and threaten to collapse this world in on itself.  It isn&#39;t clear what would happen the gods if this world perished, but I and my loved ones and millions more like us would surely be snuffed out like the humble little candle flames we are.  I cannot allow that to happen.

//todo: refresh page on click here?  I don&#39;t necessarily want a new passage, but I don&#39;t want the text wall to go on forever either

What to do though?  Every lumpkin knows that Earth and humanity are our progenitors, specifically your creativity.  So, it only seemed reasonable to bring a human creative here to help untanlge this little knot of divinity.  You create every day -- [[you must know-&gt;Wombat_Warren_Reveal]] how to turn that power off, or keep it under control?&quot;</tw-passagedata><tw-passagedata pid="29" name="Wombat_Warren_Reveal" tags="quest main_quest" position="2,823" size="100,100">&quot;Is that not really a thing you humans do?  Well, I&#39;m sure you&#39;ll figure something out!  Anyways, we need to present you to the Animal Council and discuss with them how to proceed.  We&#39;ll find them [[North-&gt;Bejeweled_Pines]] of the Frosted Forest (in which you stand currently), in the sandy savannah of the Wombat Warren.&quot;</tw-passagedata><tw-passagedata pid="30" name="Bejeweled_Pines" tags="room frosty_forest" position="2,973" size="100,100">&lt;&lt;if visited() == 1&gt;&gt;
Nuvi flaps off northward a short span, then pauses as he notes you are not beside him.  Looking back and flashing a reassuring and whiskery grin, he proffers a fuzzy little paw to you.  Squaring your shoulders with purpose, you gently take the soft paw and allow the otter to lead you through the hidden paths in the thick snow-blanketed verge.  

After some stumbling and a small labyrinth of green and whit, he leads you to
&lt;&lt;else&gt;&gt;
You stand amongst
&lt;&lt;/if&gt;&gt;
a dazzling array of colors: the trees here are no less dusted with snow than their fellows you just pushed through, but they have also been festooned with crystal and glass baubles of every conceivable hue.  [[Little soft-glowing lights-&gt;Faery_Desc]] flit from ornament to ornament, keeping the emphasis and shading dynamic.

&quot;A small tree effigy fell into this forest long ago, decorated in a similar manner. The trees here were so smitten by the style they demanded to be honored with comparable shinies and lights.  The [[dryads-&gt;Dryad_Desc]] felt abashed that trees elsewhere were so honored, and strove to worship their charges fittingly.  Unluckily for the glass-blowers and enterprising faeries, the trend did not catch on elsewhere in the forest.&quot;

Nuvi flaps down close your ear, his whiskers tickling, and he whispers,  &quot;The other trees consider these ones a bit gaudy.&quot;</tw-passagedata><tw-passagedata pid="31" name="Faery_Desc" tags="creature lumpkin description" position="250,1055" size="100,100">Peering closely at the nearest bobbing lights, you note that at the center of each little sphere is a diminutive woman (you guess about 6cm in height) with six dragonfly wings. 

&quot;Those are faeries,&quot; Nuvi informs you, &quot;whimsical little beauties with insatiable curiosity.  They trade their light for secrets, whispered by the woods; little goes on anywhere nearby that isn&#39;t witnessed by the trees.&quot;

Each faery&#39;s wings are different colors, like intricate stained glass.  As you watch, a faery winks at you and performs a graceful series of barrel rolls while the colors of her wings shift and the soft lilac light pulsing off her skin twinkles to produce a mesmerizing chromatic metamorphosis.  She giggles at your awed expression, and [[zooms off out of sight-&gt;Faery_Friend]].</tw-passagedata><tw-passagedata pid="32" name="Dryad_Desc" tags="description lumpkin creature" position="250,937" size="100,100">&quot;Dryads are the keepers of the woods.  They tend the trees, guide their growth, and defend them ferosciously.&quot;  Nuvi points a small claw toward a strange pattern along the bark of a nearby willow, and you realize a feminine face is looking back at you!  Wood creaks softly as she leans out from the tree to watch you passing.  Now that she has separated herself from the bark somewhat, you can see that a large assortment of the glitz you had taken for light cast by the tree&#39;s copious ornaments is actually jewelry.  A gleaming tiara adorns the mane of gossamer vines, leaves, and spider silk that form her waist-length hair.

&quot;They don&#39;t usually go in for all that finery, but the bejeweled dryads have as curious a sense of style as their trees.&quot;</tw-passagedata><tw-passagedata pid="33" name="Faery_Friend" tags="party_mod character shimmerin" position="58,1147" size="100,100">/*
This quest is entirely optional, and allows the player to add Shimmerin the faery to their party.  She will be useful in solving puzzles and in combat, but is not required.
*/
Nuvi hovers patiently nearby as you dart off after the faery.  She&#39;s waiting for you on the far side of the tree, and as soon as she confirms you are following her she winks cheerily and disappears into the surrounding foliage.  She seems to want you to [[chase her-&gt;Shimmerin_Chase_Ghostly_Greeting_Chamber]], but Nuvi is waiting [[back amongst the bejeweled pines-&gt;Bejeweled_Pines]].</tw-passagedata><tw-passagedata pid="34" name="Shimmerin_Chase_Ghostly_Greeting_Chamber" tags="shimmerin party_mod character quest room" position="240,1401" size="100,100">&lt;&lt;if visited() == 1&gt;&gt;
Crashing through the frosted pines as gracefully as possible for a fully grown human following a faery no larger than your little finger, you chase after the elusive sphere of lilac light.  Luckily, she&#39;s waiting just at the edge of the current clearing every time you make it through an obstacle blocking line of sight to her.  However, she has veered off in many different directions and you&#39;ve lost track of where you are relative to the Bejeweled Pines and Nuvi.
&lt;&lt;else&gt;&gt;
&lt;&lt;silent&gt;&gt;
// We only want the mole to be processed if this is not the first time in the room, since the player starts here and we want to at least potentially show the mole mechanic with the rooms to the E and S
&lt;&lt;/silent&gt;&gt;
&lt;&lt;if $anicemole.ice_mole_room is passage()&gt;&gt;
	&lt;&lt;print &quot;mole discovered!  He burrows hastily away from the human in &quot;+passage()+&quot;!&quot;&gt;&gt;
	&lt;&lt;run $anicemole.burrow()&gt;&gt;
	&lt;&lt;print &quot;Anice mole&#39;s burrowing brings him to &quot;+$anicemole.ice_mole_room+&quot;!&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;the mole wanders onward, digging digging deep down underground&quot;&gt;&gt;
	&lt;&lt;run $anicemole.advance()&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
You stand in the center of what was once a grand antechamber, for certain values of grand: everything, from the fallen grandiose pillars to the rime-encrusted iron skeletons of elaborate furniture is miniature scale relative to you.  It feels a bit like walking into a dollhouse store that a ruination of weather and time have trampled to ghostly memories. 

The faery giggles and flits off through a [[close copse of pines to the East-&gt;Shimmerin_Chase_Frozen_Stair]], leaving a sprinkle of powder in her wake. There is an [[old and sturdy rope-&gt;Shimmerin_Chase_Diamond_Throneroom]] hanging over a small cliff to the South.  Away West, a collapsed archway leads to a subtley sunken glade that may once have been a [[gallery of sorts-&gt;Shimmerin_Chase_Treasure_Of_Stillness]].


//todo: our first game element!  Surprise, surprise, it&#39;s a maze.  I don&#39;t want it to be a bunch of twisty passages all alike though; the player doesn&#39;t have enough inventory junk for that yet.  Plus those kinda suck.  There should be clear landmarks in the maze, allowing the player to actually learn and traverse it without making their own landmarks out of dropped items, BUT these landmarks should ideally shift as time goes by such that they really only exist as patterns of landscape.  That way the player has to recognize the patterns as a simple puzzle in order to navigate the maze. Shimmerin may alter things and leave false clues as well. 

// The simplest way to do something like the above would probably be to have a prefab maze in mind, and then randomly/conditionally change little bits of the descripter text for each room, and each room could be implemented as a prefab passage in Twine.  So draw that maze first!
</tw-passagedata><tw-passagedata pid="35" name="test_party_array" tags="test dev" position="752,1219" size="100,100">The starting party is: &lt;&lt;print $party&gt;&gt;, and after adding TestFriend 
&lt;&lt;script&gt;&gt;
State.variables.party.push(&quot;TestFriend&quot;);
&lt;&lt;/script&gt;&gt;
it is &lt;&lt;print $party&gt;&gt;

&lt;&lt;script&gt;&gt;
variables().party[0].name = &quot;Testy McTestFace&quot;;
alert(&quot;Player is &quot;+variables().party[0].name+&quot; whose CHA is &quot;+variables().party[0].attributes[&quot;charisma&quot;]);
&lt;&lt;/script&gt;&gt;</tw-passagedata><tw-passagedata pid="36" name="Shimmerin_Chase_Frozen_Stair" tags="shimmerin party_mod character quest room" position="376,1417" size="100,100">&lt;&lt;silently&gt;&gt;
//anicemole processing
&lt;&lt;/silently&gt;&gt;
&lt;&lt;if $anicemole.ice_mole_room is passage()&gt;&gt;
	&lt;&lt;print &quot;mole discovered!  He burrows with haste out of &quot;+passage()+&quot;!&quot;&gt;&gt;
	&lt;&lt;run $anicemole.burrow()&gt;&gt;
	&lt;&lt;print &quot;Anice mole&#39;s burrowing brings him to &quot;+$anicemole.ice_mole_room+&quot;!&quot;&gt;&gt;
	
	An ice mole is sniffing at the few valiant flowers poking up through the snow.  When he senses your approach, he jumps three feet straight in the air, and then dives into the ground just to the side of the marble tile like a breaching porpoise.
&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;the mole wanders onward, digging digging deep down underground.  His position before advance is &quot;+$anicemole.ice_mole_room&gt;&gt;
	&lt;&lt;run $anicemole.advance()&gt;&gt;
	&lt;&lt;print &quot;the mole wanders onward, digging digging deep down underground.  He snuffled off to &quot;+$anicemole.ice_mole_room&gt;&gt;
&lt;&lt;/if&gt;&gt;

Carefully hewn marble shows through the blanket of ice and snow, giving the area a feeling of patchy oppulence.  Much of the remaining stonework seems to be ornamental -- a great deal of work seems to have gone into framing the large and once-grandiose sweeping staircase that leads down into a small valley surrounded by icy cliffs.  Gold leaf on every stair adds a curious flair to the shine of sunlight off the slippery rime that flows like a runner carpet all the way down.

&lt;&lt;if not $party.includes($character_shimmerin)&gt;&gt;
You can see your fairy quarry&#39;s lilac glow disappearing down the stairs. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;if typeof $field_mods_map.get(passage()) != &#39;undefined&#39;&gt;&gt;
	&lt;&lt;if $field_mods_map.get(passage()).includes($field_mod_anicemole_burrowed)&gt;&gt;
		  A spray of dirt from the mole hole mars the otherwise pristine marble tile.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


[[You can climb (carefully!) the frozen steps down Southwest into the little vale.-&gt;Shimmerin_Chase_Diamond_Throneroom]]  Up a little curving path [[Northwest you can just make out oddly cultivated-looking shards of colorful crystal.-&gt;Shimmerin_Chase_Crystal_Gardens]]  Through a close copse of snowy pines to the [[West you can see hints of fallen grandeur.-&gt;Shimmerin_Chase_Ghostly_Greeting_Chamber]]</tw-passagedata><tw-passagedata pid="37" name="Shimmerin_Chase_Diamond_Throneroom" tags="shimmerin party_mod character quest room" position="229,1594" size="100,100">&lt;&lt;silently&gt;&gt;
//anicemole processing
&lt;&lt;/silently&gt;&gt;
&lt;&lt;if $anicemole.ice_mole_room is passage()&gt;&gt;
	&lt;&lt;print &quot;mole discovered!  He burrows with haste out of &quot;+passage()+&quot;!&quot;&gt;&gt;
	&lt;&lt;run $anicemole.burrow()&gt;&gt;
	&lt;&lt;print &quot;Anice mole&#39;s burrowing brings him to &quot;+$anicemole.ice_mole_room+&quot;!&quot;&gt;&gt;
	
	An ice mole licks the frozen waterfall gingerly, as if giving it a friendly kiss.  When he hears you tromping through the crunchy snows, he tunnels away directly into the ice and has been replaced by a mole hole faster than you could blink.
&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;the mole wanders onward, digging digging deep down underground.  His position before advance is &quot;+$anicemole.ice_mole_room&gt;&gt;
	&lt;&lt;run $anicemole.advance()&gt;&gt;
	&lt;&lt;print &quot;the mole wanders onward, digging digging deep down underground.  He snuffled off to &quot;+$anicemole.ice_mole_room&gt;&gt;
&lt;&lt;/if&gt;&gt;

You stand in a small valley surrounded by sheer cliffs of slick sapphire ice and unforgiving slate-gray stone.  The remains of graduated curved stone benches step down in a hemisphere around a clearing below and infrastructure that reminds you of the retractable roofing in fancier outdoor theatres peeks out from snow drifts here and there.  Down at the center of the declining rows of benches is a large marble dais, upon which proudly stands the most enormously overwrought chair you&#39;ve ever seen -- truly a throne.  It is majestic and imperious, with impossibly intricate and delicate gossamer weaves of crystals and gems decorating its broad frame; the morning light shining through their many hues blankets the dais in a constant rainbow corona.  The dais abutts a massive waterfall, all its roaring might condensed into a single moment frozen forever in time.  And ice.  A chill wind kisses your cheek and you shiver, feeling profoundly alone. 

&lt;&lt;if not $party.includes($character_shimmerin)&gt;&gt;
A distant lilac glow flickers with a cadence quite like giggling laughter as it dances about the waterfall&#39;s massive tusk and claw-like iceicles.  When you reach the waterfall she is already gone. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;if typeof $field_mods_map.get(passage()) != &#39;undefined&#39;&gt;&gt;
	&lt;&lt;if $field_mods_map.get(passage()).includes($field_mod_anicemole_burrowed)&gt;&gt;
		At the base of the frozen waterfall is a hole, roughly the size of a large mole.  An ice mole burrowed away from you through it.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

[[The stairs lead up Northeast and away from the lonely throne-&gt;Shimmerin_Chase_Frozen_Stair]]
[[Directly North, hanging over the ancient little throne, is the fraying end of a sturdy rope-&gt;Shimmerin_Chase_Ghostly_Greeting_Chamber]] </tw-passagedata><tw-passagedata pid="38" name="Shimmerin_Chase_Treasure_Of_Stillness" tags="shimmerin character quest party_mod room" position="70,1422" size="100,100">&lt;&lt;silently&gt;&gt;
//anicemole processing
&lt;&lt;/silently&gt;&gt;
&lt;&lt;if $anicemole.ice_mole_room is passage()&gt;&gt;
	&lt;&lt;print &quot;mole discovered!  He burrows with haste out of &quot;+passage()+&quot;!&quot;&gt;&gt;
	&lt;&lt;run $anicemole.burrow()&gt;&gt;
	&lt;&lt;print &quot;Anice mole&#39;s burrowing brings him to &quot;+$anicemole.ice_mole_room+&quot;!&quot;&gt;&gt;
	
	An ice mole patiently shovels snow with his great digging claws, to no particular purpose you can see.  His earnest little brow is furrowed, however, so you imagine he must have important duties here.  When he catches your scent on the wind, he abandons his shoveling and burrows away in a shower of glittering ice chips.
	
&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;the mole wanders onward, digging digging deep down underground.  His position before advance is &quot;+$anicemole.ice_mole_room&gt;&gt;
	&lt;&lt;run $anicemole.advance()&gt;&gt;
	&lt;&lt;print &quot;the mole wanders onward, digging digging deep down underground.  He snuffled off to &quot;+$anicemole.ice_mole_room&gt;&gt;
&lt;&lt;/if&gt;&gt;

Heaps of gold coins and gemstones lay scattered about in the snow and ice.  The coins show significant patina and undisturbed drifts blanket much of the hoard, suggesting that it has been here for some time.  As you ogle the goodies, you imagine you can hear it calling out to you, begging to be scooped up and appreciated.  Notably, several humanoid bones are interspersed with the treasures.  The air here is alarmingly still, as if the very world holds its breath. 

&lt;&lt;if not $party.includes($character_shimmerin)&gt;&gt;
You see no sign of your fairy friend here; seems she didn&#39;t wish to linger. 
&lt;&lt;/if&gt;&gt;

&lt;&lt;if typeof $field_mods_map.get(passage()) != &#39;undefined&#39;&gt;&gt;
	&lt;&lt;if $field_mods_map.get(passage()).includes($field_mod_anicemole_burrowed)&gt;&gt;
		Scattered about the mole hole are several exciting shinies: a large emerald carved in the likeness of a winking fairy, which pulses gently with a soft verdant radiance; a needle-sized sword that gleams whiter than the fresh snow, its brightness searing an impression behind your eyes; a shimmering midnight blue dress, with skirts divided for riding.  The main point of interest, however, is the tiny jewel-encrusted tiara which seems to be calling to you with a sensual humming.  
	&lt;&lt;else&gt;&gt;
		In addition to all the loose treasure, you can see faint glimmering from within the ice; you note that there may be yet more wonders held prisoner in its frosty grip.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

// todo: add options for the player to steal surface treasure or enact other mischief and receive a mild rebuke for it (magical shock or similar for mischief, maybe death for stealing... maybe first a shock as warning then death if player doesn&#39;t reverse action) to establish precedent for why faeries couldn&#39;t actively startle the mole and manipulate him into burrowing the tiara out.

Up a gradual incline and over the remains of a once-sturdy gate to the [[Northeast, you can see several oddly pointy bushes glittering in the verdant sunlight. -&gt;Shimmerin_Chase_Crystal_Gardens]]  Down a slightly harsh rockfall (best to slide, but watch your rump!) [[Southeast lies a lonely little frosted valley.-&gt;Shimmerin_Chase_Diamond_Throneroom]]  Up the slope and over the sad ruins of a once fancy archway stand the bases of mighty pillars that once supported a grand antechamber [[East of here.-&gt;Shimmerin_Chase_Ghostly_Greeting_Chamber]]</tw-passagedata><tw-passagedata pid="39" name="Shimmerin_Chase_Crystal_Gardens" tags="shimmerin character party_mod quest room" position="240,1236" size="100,100">&lt;&lt;silently&gt;&gt;
//anicemole processing
&lt;&lt;/silently&gt;&gt;
&lt;&lt;if $anicemole.ice_mole_room is passage()&gt;&gt;
	&lt;&lt;print &quot;mole discovered!  He burrows with haste out of &quot;+passage()+&quot;!&quot;&gt;&gt;
	&lt;&lt;run $anicemole.burrow()&gt;&gt;
	&lt;&lt;print &quot;Anice mole&#39;s burrowing brings him to &quot;+$anicemole.ice_mole_room+&quot;!&quot;&gt;&gt;
	
	An ice mole snuffles about busily beneath a huge growth of emeralds in the shape of a towering oak tree.  His giant claws scrape patiently away at the &#39;roots&#39;, hard enough to chip away the stone.  When the mole sees you approaching, he panics and dives beneath the ice and snow at the base of the emerald tree.  His frenzied digging upsets the root system, which is apparently a thing, and the emerald oak comes crashing to the ground, throwing up a mist of powdery snow that glitters in the multi-hued sunlight. 
	
&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;the mole wanders onward, digging digging deep down underground.  His position before advance is &quot;+$anicemole.ice_mole_room&gt;&gt;
	&lt;&lt;run $anicemole.advance()&gt;&gt;
	&lt;&lt;print &quot;the mole wanders onward, digging digging deep down underground.  He snuffled off to &quot;+$anicemole.ice_mole_room&gt;&gt;
&lt;&lt;/if&gt;&gt;

You stand in a large clearing where someone has apparently cultivated a vast garden of crystals.  Instead of the soft greens of pine and holly, eldritch purples, blues, reds, and every color imaginable (and a few that are like no color you&#39;ve imagined previously) filter the subtle sunlight into spectacular rainbows over you.  The dusting of snow only mutes the effect slightly, pleasantly keeping it mysterious rather than gaudy.  Faeries flit amongst the crystalline horticulture, adding their own colors to the filtered sunlight.  Brushing by an explosion of amethyst that looks a bit lke the leaves of a pineapple, you shy away as a sharp pain stings your arm and a warm rivulet of blood seeps into your clothing -- the verge here is beautiful and deadly. 

Several of the crystals are carved to look like fanciful animals (or, here, regular animals) reading books and wearing stylish clothes.  There are humans too, as well as a few winged humanoids that might be faeries; you note that they are the same size.  The time and care involved in cultivating and pruning crystal topiary boggles your mind. 
As a cool wind ruffles the distant foliage, the crystal garden produces a light tinkling that settles into a deeper resonant hum as the garden vibrates. 

&lt;&lt;if not $party.includes($character_shimmerin)&gt;&gt;
The fairy you&#39;re chasing peeks out from behind a sapphire flower as tall as you.  When she sees you approaching, she winks flirtatiously and blows you a little kiss.  

	&lt;&lt;if $inventory.includes($summer_court_tiara)&gt;&gt;
		Then, her eyes shift to your pack, which has begun to hum and vibrate softly.  Zooming over in a blur of enthusiasm, the little fairy opens your pack, dives in, and emerges holding reverently the tiny tiara you picked up in the treasure room.
		
		&quot;This... how did you get this?&quot; she asks, breathlessly, her face a mask of astonishment and all pretense of teasing silliness forgotten.  &quot;It&#39;s the Summer Queen&#39;s own tiara, and has been lost to us since the fall of the courts centuries ago.  Everything hears its call, faeries most of all, so we knew it was under the ice amongst the forsaken treasures but no one could get past the treasure&#39;s curse to reach it!&quot;
		// todo: the question should be more how rather than where, since the treasure room is right over there.  I would say the focus should be on the treasure&#39;s curse repelling raiders, and the mole&#39;s pure goodness and innocence making it immune.  As for why the fairy never noticed that, well maybe the mole isn&#39;t frightened of them and/or maybe they don&#39;t have the attention to detail necessary to set up the mole to dig things out for them.
		
		// todo: do we want a conversation here?  It could be done without too too much hassle by setting control vars to manage the passage text here and adding an exit conversation link in the conversation branch passages that comes back here.  Does it serve a purpose, however?  On the one hand, we could force the player&#39;s tongue here and give their truthful answer about the mole which would allow Shimmerin to respond that she never noticed the mole digging frenziedly and/or was unable/unwilling to frighten it.  On the other hand, we could let the player lie or ignore Shimmerin, which would mod her affinity.  We could even give the player a CHA score, which can be influenced by equipment etc, which influences the likelihood of the bluff succeeding.  I guess the main question is: is there a response the player could give that would significantly (i.e. not just slight affinity mod) change something re: Shimmerin in the story going forward?  Eh, I suppose so: maybe Shimmerin decides that the player must be as good-hearted and earnest as a mole and the aff takes a big jump up AND we add &#39;mole-level-good&#39; to her inductive bias re: the player, which could well have important consequences later (e.g. she assumes something that can&#39;t hurt the pure of heart can&#39;t hurt the player, and so doesn&#39;t warn them...)
	&lt;&lt;else&gt;&gt;
		Simultaneously, blinding beautiful light explodes from every one of the innumerable crystals in the garden, and when you can see again you see that the little fairy has vanished. 
	&lt;&lt;/if&gt;&gt;
	

&lt;&lt;/if&gt;&gt;

&lt;&lt;if typeof $field_mods_map.get(passage()) != &#39;undefined&#39;&gt;&gt;
	&lt;&lt;if $field_mods_map.get(passage()).includes($field_mod_anicemole_burrowed)&gt;&gt;
		  Emerald shards lay scattered about where the crystal oak fell after the ice mole burrowed away beneath it.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

The ground slopes downward in a gently meandering curve heading [[Southeast to a large clearing that frames a set of grandiose stairs that descend out of sight.-&gt;Shimmerin_Chase_Frozen_Stair]]  Just over the lip of a once ornate gate to the Southwest you can see a shallow hill with bumps of ice (most likely hiding buried steps) leading down into a [[gallery frozen forever in its final moment of splendor-&gt;Shimmerin_Chase_Treasure_Of_Stillness]].</tw-passagedata></tw-storydata>